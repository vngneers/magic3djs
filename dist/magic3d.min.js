/*
Magic3D Version 1.0
Author: vngneers
Description: This library helps to enable 3D rotation (Using 3D transform) on any flat 2d image or html element without any need of 3d images.
License: GNU GPLv3
Usage:
var rotator = new Magic3D({
	elementId: "content1",
	clipping: 50,
	maxDeg : 10,
	width: 400,
	height: 400
});

OR

var rotator = new Magic3D({
	elements: document.getElementsByClassName("class-name");
	clipping: 50,
	maxDeg : 10,
	width: 150,
	height: 150
});
*/
"use strict";var Magic3D=function(a){var b=document.getElementById(a.elementId)||a.elements;if(!b)return!1;b.length||(b=[b]);for(var c=0;c<b.length;c++){new Magic3D_ThreeD_Transform_Rotate({element:b[c],clipping:a.clipping,maxDeg:a.maxDeg,width:a.width,height:a.height,perspective:a.perspective,easingBy:a.easingBy})}},Magic3D_ThreeD_Transform_Rotate=function(a){this.target=void 0,this.holder=void 0,this.config=void 0,this.currentDegX=0,this.currentDegY=0;var b=this;this.setDefaultConfig=function(a){this.config=this.config||{},this.config.elementId=a.elementId,this.config.perspective=a.perspective||100,this.config.clipping=a.clipping||0,this.config.maxDeg=a.maxDeg||10,this.config.easingBy=a.easingBy||20,this.config.width=a.width,this.config.height=a.height,this.config.element=a.element,this.config.horizontalRotation=!0,this.config.verticalRotation=!1},this.init=function(a){this.setDefaultConfig(a);try{this.target=this.config.element||this.getImgElement(this.config.elementId),this.initUI(this.target),this.initEvents(this.target)}catch(b){throw b}},this.initUI=function(a){var b=this.config.width||a.offsetWidth,c=this.config.height||a.offsetHeight;this.holder=document.createElement("div"),a.parentElement.insertBefore(this.holder,a),this.holder.appendChild(a),this.holder.className="ThreeD_Holder",this.holder.style.perspective=this.config.perspective+"px",this.holder.style.overflow="hidden",this.holder.style.width=b,this.holder.style.height=c-2*this.config.clipping,this.setElementNotDraggable(this.holder),a.style.width=b,a.style.height=c,a.style.transform="rotateY(0deg)",a.style.position="relative",a.style.top=-1*this.config.clipping,this.setElementNotDraggable(a)},this.setElementNotDraggable=function(a){Magic3D_EventListener(a,"dragstart",this.dragHandler)},this.dragHandler=function(a){return a.preventDefault(),!1},this.initEvents=function(a){var b=new Magic3D_ElementDrag(a);Magic3D_EventListener(a,b.Dragging_Event,this.rotate3DHandler),Magic3D_EventListener(a,b.DraggingEnd_Event,this.rotate3DEndHandler)},this.rotate3DEndHandler=function(a){},this.rotate3DHandler=function(a){b.rotate3D(a.detail)},this.rotate3D=function(a){var b="center",c="center";this.config.horizontalRotation&&(b=this.rotate3DHorizontal(a)),this.config.verticalRotation&&(c=this.rotate3DVertical(a)),this.holder.style.perspectiveOrigin=b+" "+c},this.rotate3DHorizontal=function(a){var b=a.offsetX,c=a.directionX,d=0,e=this.config.maxDeg;return d=this.currentDegX+b/this.config.easingBy,d="right"==c?Math.min(d,e):Math.max(d,-1*e),this.currentDegX=d,this.target.style.transform="rotateY("+this.currentDegX+"deg)",this.currentDegX>0?"left":"right"},this.rotate3DVertical=function(a){var b=a.offsetY,c=a.directionY,d=0,e=this.config.maxDeg;return d=this.currentDegY+b/this.config.easingBy,d="bottom"==c?Math.min(d,e):Math.max(d,-1*e),this.currentDegY=d,this.target.style.transform="rotateX("+this.currentDegY+"deg)",this.currentDegY>0?"bottom":"top"},this.getImgElement=function(a){var b=document.getElementById(a);if(!b)throw new DOMException("No Image Element found with id:"+a);return b},this.init(a)},Magic3D_ElementDrag=function(a){this.registeredX=-1,this.registeredY=-1,this.Dragging_Event="dragging",this.DraggingEnd_Event="draggingend";var b=this;this.init=function(a){Magic3D_EventListener(a,"mousedown",this.mouseDownHandler),Magic3D_EventListener(a,"mousemove",this.mouseMoveHandler),Magic3D_EventListener(document,"mouseup",this.mouseUpHandler),Magic3D_EventListener(a,"mouseup",this.mouseUpHandler),Magic3D_EventListener(a,"touchstart",this.touchStartHandler),Magic3D_EventListener(a,"touchmove",this.touchMoveHandler),Magic3D_EventListener(a,"touchend",this.touchEndHandler)},this.registerStartPosition=function(a,b){this.registeredX=a,this.registeredY=b},this.drag=function(b,c){if(this.registeredX<0||this.registeredY<0)return!1;var d=b-this.registeredX,e=b>this.registeredX?"right":"left",f=c-this.registeredY,g=c>this.registeredY?"bottom":"top",h=document.createEvent("CustomEvent");h.initCustomEvent(this.Dragging_Event,!0,!0,{offsetX:d,directionX:e,offsetY:f,directionY:g}),a.dispatchEvent(h)},this.stopDrag=function(){this.registeredX=-1;var b=document.createEvent("CustomEvent");b.initCustomEvent(this.DraggingEnd_Event,!0,!0),a.dispatchEvent(b)},this.mouseDownHandler=function(a){return b.registerStartPosition(a.offsetX,a.offsetY),!1},this.mouseMoveHandler=function(a){return b.drag(a.offsetX,a.offsetY),!1},this.mouseUpHandler=function(a){return b.stopDrag(),!1},this.touchStartHandler=function(a){return 1==a.touches.length?(b.registerStartPosition(a.touches[0].clientX,a.touches[0].clientY),a.preventDefault(),!1):void 0},this.touchMoveHandler=function(a){return 1==a.touches.length?(b.drag(a.touches[0].clientX,a.touches[0].clientY),a.preventDefault(),!1):void 0},this.touchEndHandler=function(a){b.stopDrag()},this.init(a)},Magic3D_EventListener=function(a,b,c){document.addEventListener?a.addEventListener(b,c):document.attachEvent&&a.attachEvent(b,c)};